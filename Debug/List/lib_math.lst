###############################################################################
#
# IAR ANSI C/C++ Compiler V8.22.1.15669/W32 for ARM       20/Dec/2025  11:44:49
# Copyright 1999-2018 IAR Systems AB.
#
#    Cpu mode     =  thumb
#    Endian       =  little
#    Source file  =  
#        C:\Users\pnu3\Desktop\deskproject\Embedded_System_TermProject\Micrium\Software\uC-LIB\lib_math.c
#    Command line =  
#        -f C:\Users\pnu3\AppData\Local\Temp\EW24E6.tmp
#        (C:\Users\pnu3\Desktop\deskproject\Embedded_System_TermProject\Micrium\Software\uC-LIB\lib_math.c
#        -D USE_STDPERIPH_DRIVER -D STM32F10X_CL -lC
#        C:\Users\pnu3\Desktop\deskproject\Embedded_System_TermProject\Debug\List
#        -o
#        C:\Users\pnu3\Desktop\deskproject\Embedded_System_TermProject\Debug\Obj
#        --no_cse --no_unroll --no_inline --no_code_motion --no_tbaa
#        --no_clustering --no_scheduling --debug --endian=little
#        --cpu=Cortex-M3 -e --fpu=None --dlib_config "C:\Program Files
#        (x86)\IAR Systems\Embedded Workbench
#        8.0\arm\INC\c\DLib_Config_Normal.h" -I
#        C:\Users\pnu3\Desktop\deskproject\Embedded_System_TermProject\libraries\CMSIS\DeviceSupport\
#        -I
#        C:\Users\pnu3\Desktop\deskproject\Embedded_System_TermProject\libraries\CMSIS\DeviceSupport\Startup\
#        -I
#        C:\Users\pnu3\Desktop\deskproject\Embedded_System_TermProject\libraries\STM32F10x_StdPeriph_Driver_v3.5\inc\
#        -I
#        C:\Users\pnu3\Desktop\deskproject\Embedded_System_TermProject\libraries\STM32F10x_StdPeriph_Driver_v3.5\src\
#        -I C:\Users\pnu3\Desktop\deskproject\Embedded_System_TermProject\user\
#        -I
#        C:\Users\pnu3\Desktop\deskproject\Embedded_System_TermProject\user\inc\
#        -I
#        C:\Users\pnu3\Desktop\deskproject\Embedded_System_TermProject\libraries\LCD\
#        -I
#        C:\Users\pnu3\Desktop\deskproject\Embedded_System_TermProject\Micrium\Software\uC-CPU\
#        -I
#        C:\Users\pnu3\Desktop\deskproject\Embedded_System_TermProject\Micrium\Software\uC-CPU\ARM-Cortex-M\ARMv7-M\IAR\
#        -I
#        C:\Users\pnu3\Desktop\deskproject\Embedded_System_TermProject\Micrium\Software\uCOS-III\Source\
#        -I
#        C:\Users\pnu3\Desktop\deskproject\Embedded_System_TermProject\Micrium\Software\uCOS-III\Ports\ARM-Cortex-M\ARMv7-M\IAR\
#        -I
#        C:\Users\pnu3\Desktop\deskproject\Embedded_System_TermProject\user\uCOS-III\
#        -I
#        C:\Users\pnu3\Desktop\deskproject\Embedded_System_TermProject\Micrium\Software\uC-LIB\
#        -Ol -I "C:\Program Files (x86)\IAR Systems\Embedded Workbench
#        8.0\arm\CMSIS\Core\Include\" -I "C:\Program Files (x86)\IAR
#        Systems\Embedded Workbench 8.0\arm\CMSIS\DSP\Include\")
#    Locale       =  C
#    List file    =  
#        C:\Users\pnu3\Desktop\deskproject\Embedded_System_TermProject\Debug\List\lib_math.lst
#    Object file  =  
#        C:\Users\pnu3\Desktop\deskproject\Embedded_System_TermProject\Debug\Obj\lib_math.o
#
###############################################################################

C:\Users\pnu3\Desktop\deskproject\Embedded_System_TermProject\Micrium\Software\uC-LIB\lib_math.c
      1          /*
      2          *********************************************************************************************************
      3          *                                               uC/LIB
      4          *                                       Custom Library Modules
      5          *
      6          *                    Copyright 2004-2021 Silicon Laboratories Inc. www.silabs.com
      7          *
      8          *                                 SPDX-License-Identifier: APACHE-2.0
      9          *
     10          *               This software is subject to an open source license and is distributed by
     11          *                Silicon Laboratories Inc. pursuant to the terms of the Apache License,
     12          *                    Version 2.0 available at www.apache.org/licenses/LICENSE-2.0.
     13          *
     14          *********************************************************************************************************
     15          */
     16          
     17          /*
     18          *********************************************************************************************************
     19          *
     20          *                                        MATHEMATIC OPERATIONS
     21          *
     22          * Filename  : lib_math.c
     23          * Version   : V1.39.01
     24          *********************************************************************************************************
     25          * Note(s)   : (1) NO compiler-supplied standard library functions are used in library or product software.
     26          *
     27          *                 (a) ALL standard library functions are implemented in the custom library modules :
     28          *
     29          *                     (1) \<Custom Library Directory>\lib_*.*
     30          *
     31          *                     (2) \<Custom Library Directory>\Ports\<cpu>\<compiler>\lib*_a.*
     32          *
     33          *                           where
     34          *                                   <Custom Library Directory>      directory path for custom library software
     35          *                                   <cpu>                           directory name for specific processor (CPU)
     36          *                                   <compiler>                      directory name for specific compiler
     37          *
     38          *                 (b) Product-specific library functions are implemented in individual products.
     39          *
     40          *********************************************************************************************************
     41          * Notice(s) : (1) The Institute of Electrical and Electronics Engineers and The Open Group, have given
     42          *                 us permission to reprint portions of their documentation.  Portions of this text are
     43          *                 reprinted and reproduced in electronic form from the IEEE Std 1003.1, 2004 Edition,
     44          *                 Standard for Information Technology -- Portable Operating System Interface (POSIX),
     45          *                 The Open Group Base Specifications Issue 6, Copyright (C) 2001-2004 by the Institute
     46          *                 of Electrical and Electronics Engineers, Inc and The Open Group.  In the event of any
     47          *                 discrepancy between these versions and the original IEEE and The Open Group Standard,
     48          *                 the original IEEE and The Open Group Standard is the referee document.  The original
     49          *                 Standard can be obtained online at http://www.opengroup.org/unix/online.html.
     50          *********************************************************************************************************
     51          */
     52          
     53          /*
     54          *********************************************************************************************************
     55          *                                            INCLUDE FILES
     56          *********************************************************************************************************
     57          */
     58          
     59          #define    MICRIUM_SOURCE
     60          #define    LIB_MATH_MODULE
     61          #include  <lib_math.h>
     62          
     63          
     64          /*
     65          *********************************************************************************************************
     66          *                                            LOCAL DEFINES
     67          *********************************************************************************************************
     68          */
     69          
     70          
     71          /*
     72          *********************************************************************************************************
     73          *                                           LOCAL CONSTANTS
     74          *********************************************************************************************************
     75          */
     76          
     77          
     78          /*
     79          *********************************************************************************************************
     80          *                                          LOCAL DATA TYPES
     81          *********************************************************************************************************
     82          */
     83          
     84          
     85          /*
     86          *********************************************************************************************************
     87          *                                            LOCAL TABLES
     88          *********************************************************************************************************
     89          */
     90          
     91          
     92          /*
     93          *********************************************************************************************************
     94          *                                       LOCAL GLOBAL VARIABLES
     95          *********************************************************************************************************
     96          */
     97          

   \                                 In section .bss, align 4
     98          RAND_NBR  Math_RandSeedCur;                                     /* Cur rand nbr seed.                                   */
   \                     Math_RandSeedCur:
   \   00000000                      DS8 4
     99          
    100          
    101          /*
    102          *********************************************************************************************************
    103          *                                      LOCAL FUNCTION PROTOTYPES
    104          *********************************************************************************************************
    105          */
    106          
    107          
    108          /*
    109          *********************************************************************************************************
    110          *                                     LOCAL CONFIGURATION ERRORS
    111          *********************************************************************************************************
    112          */
    113          
    114          
    115          /*
    116          *********************************************************************************************************
    117          *                                             Math_Init()
    118          *
    119          * Description : (1) Initialize Mathematic Module :
    120          *
    121          *                   (a) Initialize random number seed value
    122          *
    123          *
    124          * Argument(s) : none.
    125          *
    126          * Return(s)   : none.
    127          *
    128          * Caller(s)   : Application.
    129          *
    130          * Note(s)     : (2) IEEE Std 1003.1, 2004 Edition, Section 'rand() : DESCRIPTION' states that "if rand()
    131          *                   is called before any calls to srand() are made, the same sequence shall be generated
    132          *                   as when srand() is first called with a seed value of 1".
    133          *********************************************************************************************************
    134          */
    135          

   \                                 In section .text, align 2, keep-with-next
    136          void  Math_Init (void)
    137          {
   \                     Math_Init: (+1)
   \   00000000   0xB580             PUSH     {R7,LR}
    138              Math_RandSetSeed((RAND_NBR)RAND_SEED_INIT_VAL);             /* See Note #2.                                         */
   \   00000002   0x2001             MOVS     R0,#+1
   \   00000004   0x.... 0x....      BL       Math_RandSetSeed
    139          }
   \   00000008   0xBD01             POP      {R0,PC}          ;; return
    140          
    141          
    142          /*
    143          *********************************************************************************************************
    144          *                                         Math_RandSetSeed()
    145          *
    146          * Description : Set the current pseudo-random number generator seed.
    147          *
    148          * Argument(s) : seed        Initial (or current) value to set for the pseudo-random number sequence.
    149          *
    150          * Return(s)   : none.
    151          *
    152          * Caller(s)   : Application.
    153          *
    154          * Note(s)     : (1) IEEE Std 1003.1, 2004 Edition, Section 'rand() : DESCRIPTION' states that "srand()
    155          *                   ... uses the argument as a seed for a new sequence of pseudo-random numbers to be
    156          *                   returned by subsequent calls to rand()".
    157          *
    158          *               (2) 'Math_RandSeedCur' MUST always be accessed exclusively in critical sections.
    159          *
    160          *                   See also 'Math_Rand()  Note #1b'.
    161          *********************************************************************************************************
    162          */
    163          

   \                                 In section .text, align 2, keep-with-next
    164          void  Math_RandSetSeed (RAND_NBR  seed)
    165          {
   \                     Math_RandSetSeed: (+1)
   \   00000000   0xB510             PUSH     {R4,LR}
   \   00000002   0x0004             MOVS     R4,R0
    166              CPU_SR_ALLOC();
   \   00000004   0x2000             MOVS     R0,#+0
    167          
    168          
    169              CPU_CRITICAL_ENTER();
   \   00000006   0x2040             MOVS     R0,#+64
   \   00000008   0x.... 0x....      BL       CPU_SR_Save
    170              Math_RandSeedCur = seed;
   \   0000000C   0x....             LDR.N    R1,??DataTable3
   \   0000000E   0x600C             STR      R4,[R1, #+0]
    171              CPU_CRITICAL_EXIT();
   \   00000010   0x.... 0x....      BL       CPU_SR_Restore
    172          }
   \   00000014   0xBD10             POP      {R4,PC}          ;; return
    173          
    174          
    175          /*
    176          *********************************************************************************************************
    177          *                                             Math_Rand()
    178          *
    179          * Description : Calculate the next pseudo-random number.
    180          *
    181          * Argument(s) : none.
    182          *
    183          * Return(s)   : Next pseudo-random number in the sequence after 'Math_RandSeedCur'.
    184          *
    185          * Caller(s)   : Application.
    186          *
    187          * Note(s)     : (1) (a) The pseudo-random number generator is implemented as a Linear Congruential
    188          *                       Generator (LCG).
    189          *
    190          *                   (b) The pseudo-random number generated is in the range [0, RAND_LCG_PARAM_M].
    191          *
    192          *                   See also 'Math_RandSeed()  Note #1'.
    193          *
    194          *               (2) (a) IEEE Std 1003.1, 2004 Edition, Section 'rand() : DESCRIPTION' states that "rand()
    195          *                       ... need not be reentrant ... [and] is not required to be thread-safe".
    196          *
    197          *                   (b) However, in order to implement Math_Rand() as re-entrant; 'Math_RandSeedCur' MUST
    198          *                       always be accessed & updated exclusively in critical sections.
    199          *
    200          *                   See also 'Math_RandSeed()  Note #2'.
    201          *********************************************************************************************************
    202          */
    203          

   \                                 In section .text, align 2, keep-with-next
    204          RAND_NBR  Math_Rand (void)
    205          {
   \                     Math_Rand: (+1)
   \   00000000   0xB538             PUSH     {R3-R5,LR}
    206              RAND_NBR  seed;
    207              RAND_NBR  rand_nbr;
    208              CPU_SR_ALLOC();
   \   00000002   0x2000             MOVS     R0,#+0
    209          
    210          
    211              CPU_CRITICAL_ENTER();
   \   00000004   0x2040             MOVS     R0,#+64
   \   00000006   0x.... 0x....      BL       CPU_SR_Save
   \   0000000A   0x0005             MOVS     R5,R0
    212              seed             = Math_RandSeedCur;
   \   0000000C   0x....             LDR.N    R0,??DataTable3
   \   0000000E   0x6800             LDR      R0,[R0, #+0]
    213              rand_nbr         = Math_RandSeed(seed);
   \   00000010   0x.... 0x....      BL       Math_RandSeed
   \   00000014   0x0004             MOVS     R4,R0
    214              Math_RandSeedCur = rand_nbr;
   \   00000016   0x....             LDR.N    R0,??DataTable3
   \   00000018   0x6004             STR      R4,[R0, #+0]
    215              CPU_CRITICAL_EXIT();
   \   0000001A   0x0028             MOVS     R0,R5
   \   0000001C   0x.... 0x....      BL       CPU_SR_Restore
    216          
    217              return (rand_nbr);
   \   00000020   0x0020             MOVS     R0,R4
   \   00000022   0xBD32             POP      {R1,R4,R5,PC}    ;; return
    218          }
    219          
    220          
    221          /*
    222          *********************************************************************************************************
    223          *                                           Math_RandSeed()
    224          *
    225          * Description : Calculate the next pseudo-random number.
    226          *
    227          * Argument(s) : seed        Initial (or current) value for the pseudo-random number sequence.
    228          *
    229          * Return(s)   : Next pseudo-random number in the sequence after 'seed'.
    230          *
    231          * Caller(s)   : Math_Rand(),
    232          *               Application.
    233          *
    234          * Note(s)     : (1) (a) BSD/ANSI-C implements rand() as a Linear Congruential Generator (LCG) :
    235          *
    236          *                       (A) random_number       =  [(a * random_number ) + b]  modulo m
    237          *                                        n + 1                        n
    238          *
    239          *                               where
    240          *                                       (1) (a) random_number           Next     random number to generate
    241          *                                                            n+1
    242          *                                           (b) random_number           Previous random number    generated
    243          *                                                            n
    244          *
    245          *                                       (2) a = RAND_LCG_PARAM_A        LCG multiplier
    246          *                                       (3) b = RAND_LCG_PARAM_B        LCG incrementor
    247          *                                       (4) m = RAND_LCG_PARAM_M + 1    LCG modulus
    248          *
    249          *                   (b) The pseudo-random number generated is in the range [0, RAND_LCG_PARAM_M].
    250          *
    251                              See also 'lib_math.h  RANDOM NUMBER DEFINES  Note #1b'.
    252          *
    253          *               (2) (a) IEEE Std 1003.1, 2004 Edition, Section 'rand() : DESCRIPTION' states that "rand()
    254          *                       ... need not be reentrant ... [and] is not required to be thread-safe".
    255          *
    256          *                   (b) However, Math_RandSeed() is re-entrant since it calculates the next random number
    257          *                       using ONLY local variables.
    258          *********************************************************************************************************
    259          */
    260          

   \                                 In section .text, align 2, keep-with-next
    261          RAND_NBR  Math_RandSeed (RAND_NBR  seed)
    262          {
    263              RAND_NBR  rand_nbr;
    264          
    265          
    266              rand_nbr = (((RAND_NBR)RAND_LCG_PARAM_A * seed) + (RAND_NBR)RAND_LCG_PARAM_B)  %  ((RAND_NBR)RAND_LCG_PARAM_M + 1u);
   \                     Math_RandSeed: (+1)
   \   00000000   0x....             LDR.N    R2,??DataTable3_1  ;; 0x41c64e6d
   \   00000002   0xF243 0x0139      MOVW     R1,#+12345
   \   00000006   0xFB02 0x1000      MLA      R0,R2,R0,R1
   \   0000000A   0xF020 0x4000      BIC      R0,R0,#0x80000000
    267          
    268              return (rand_nbr);
   \   0000000E   0x4770             BX       LR               ;; return
    269          }

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable3:
   \   00000000   0x........         DC32     Math_RandSeedCur

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable3_1:
   \   00000000   0x41C64E6D         DC32     0x41c64e6d

   Maximum stack usage in bytes:

   .cstack Function
   ------- --------
       8   Math_Init
         8   -> Math_RandSetSeed
      16   Math_Rand
        16   -> CPU_SR_Restore
        16   -> CPU_SR_Save
        16   -> Math_RandSeed
       0   Math_RandSeed
       8   Math_RandSetSeed
         8   -> CPU_SR_Restore
         8   -> CPU_SR_Save


   Section sizes:

   Bytes  Function/Label
   -----  --------------
       4  ??DataTable3
       4  ??DataTable3_1
      10  Math_Init
      36  Math_Rand
      16  Math_RandSeed
       4  Math_RandSeedCur
      22  Math_RandSetSeed

 
  4 bytes in section .bss
 92 bytes in section .text
 
 92 bytes of CODE memory
  4 bytes of DATA memory

Errors: none
Warnings: none
